FROM node:16.18.1 as build_stage


# Set the working directory
WORKDIR /build

# Copy in the project files
COPY dist/packages/razzle-account-manager/* ./
# Install the dependencies
RUN npm install --legacy-peer-deps
RUN npm install @razzledotai/sdk --legacy-peer-deps

# Copy the build files to the production image
FROM node:16.17.1-alpine AS run_stage

WORKDIR /app
COPY --from=build_stage /build/* ./


ENV RAZZLE_APP_ID=
ENV RAZZLE_API_KEY=
ENV RAZZLE_API_KEY=
ENV RAZZLE_WS_URL=
ENV RAZZLE_API_BASE_URL=

# Expose the port
EXPOSE 3011

# Start the server
CMD node ./main.js
